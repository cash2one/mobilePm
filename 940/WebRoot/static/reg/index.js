Fengs.add("940/reg/index",function(s,e){return{regFn:function(){function s(){var s=e("#name").val(),t=e("#password").val();e.ajax({type:"post",url:"/register",data:{user_name:s,password:t},dataType:"json",success:function(a){"1"==a.status?(l.removeClass("error").addClass("succ").html("注册成功，即将跳转到首页！"),e.cookie("940_COM_USER",s,{path:"/"}),e.cookie("940_COM_PASS",t,{path:"/"}),setTimeout(function(){window.location.href="/"},2e3)):r().html(a.tips)}})}function r(){return clearTimeout(d),d=setTimeout(function(){l.removeClass("error succ")},2e3),l.addClass("error")}this.aInpt=e("#name,#password,#passwords,#validCode"),this.aInpt.val(""),e.browser.msie&&Number(e.browser.version)<=9&&this.pointtxt();var t=!1,a=!1;this.aInpt.blur(function(){switch(this.id){case"name":n.name(e(this));break;case"password":n.password(e(this));break;case"passwords":n.passwords(e(this));break;case"validCode":n.validCode(e(this))}}).focus(function(){function s(s){var r,t,a,i,o=e(s).val(),n=o.length;if(0==n)return 1;if(n>12&&e(s).val(o.match(/.{12}/g)[0]),r=/\d/.test(o),t=/[a-z]/.test(o),a=/\W|[A-Z]/.test(o),i=r+t+a,6>n)return 1;if(n>=6&&7>=n){if(1==i)return 1;if(i>=2)return 2}if(n>7&&12>=n){if(1==i)return 1;if(2==i)return 2;if(3==i)return 3}}"password"==this.id&&e(this).keyup(function(){var r=e(this),t=s(r),a=r.siblings(".stren").show();r.siblings(".cue").hide(),1==t?a.removeClass("st2 st3").addClass("st1"):2==t?a.removeClass("st1 st3").addClass("st2"):3==t&&a.removeClass("st1 st2").addClass("st3")})});var i=e(".reg_checkbox"),o=i.find(".check"),n={name:function(s){var e=s.val(),r=s.siblings(".cue");c.Email.test(e)?(r.removeClass("error").addClass("correct"),t=!0):(r.removeClass("correct").addClass("error"),t=!1)},password:function(s){var e=s.val(),r=s.siblings(".cue");return e.length<6||e.length>12?(s.siblings(".stren").hide(),r.show().removeClass("correct").addClass("error"),t=!1,!1):(t=!0,!0)},passwords:function(s){var r=s.val(),a=e("#password").val(),i=s.siblings(".cue");r==a&&this.password(e("#password"))?(i.removeClass("error").addClass("correct"),t=!0):(i.removeClass("correct").addClass("error"),t=!1)},validCode:function(s){var r=s.val(),i=s.siblings(".cue");t&&e.getJSON("/checkCode?code="+r,function(s){1==s.status?(i.removeClass("error").addClass("correct"),a=!0):(i.removeClass("correct").addClass("error"),a=!1,e(".change_reg").siblings("img").attr("src","/code.jpeg?"+(new Date).getTime()))})},Protocol:function(){i.children().click(function(){o.is(".checked")?o.removeClass("checked"):o.addClass("checked")})}(),Code:function(){e(".change_reg").click(function(){e(this).siblings("img").attr("src","/code.jpeg?"+(new Date).getTime()),a=!1})}()},c={Email:/^[^\W|0]\w+@\w+(\.[a-z]{2,3}){1,2}$/},l=e("#regBox span"),d=null;e("#submit").click(function(){e("#name,#password,#passwords,#validCode").blur(),t&&a&&(o.is(".checked")?s():r().html("请勾选 版权声明 和 隐私保护 条款"))})},pointtxt:function(){for(var s=e(".reg_ul").find(".li_input"),r=["用户名 (邮箱)","设置密码 (6-12位)","确认密码","请输入图片中的验证码"],t=0;t<s.length;t++)s.eq(t).append("<font class='point'>"+r[t]+"</font>");s.find(".point").click(function(){e(this).siblings("input").focus()}),this.aInpt.focus(function(){var s=e(this).val();""==s&&e(this).siblings(".point").hide()}).blur(function(){var s=e(this).val();""==s&&e(this).siblings(".point").show()})}}},["jquery/cookie"]);