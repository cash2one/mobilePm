Fengs.add("940/user/qqFace",function(e,t){!function(e){e.fn.qqFace=function(t){var n={id:"facebox",path:"face/",assign:"content",tip:"em_"},i=e.extend(n,t),o=e("#"+i.assign),a=i.id,c=i.path,s=i.tip;return o.length<=0?(alert("缺少表情赋值对象。"),!1):(e(this).click(function(t){var n,o;if(e("#"+a).length<=0){n='<div id="'+a+'" style="position:absolute;display:none;z-index:1000;" class="qqFace"><table border="0" cellspacing="0" cellpadding="0"><tr>';for(var r=1;75>=r;r++)o="["+s+r+"]",n+='<td><img src="'+c+r+'.gif" onclick="$(\'#'+i.assign+"').setCaret();$('#"+i.assign+"').insertAtCaret('"+o+"');\" /></td>",r%15==0&&(n+="</tr><tr>");n+="</tr></table></div>"}e(this).parent().append(n);var l=e(this).position(),d=l.top+e(this).outerHeight();e("#"+a).css("top",d),e("#"+a).css("left",l.left),e("#"+a).show(),t.stopPropagation()}),void e(document).click(function(){e("#"+a).hide(),e("#"+a).remove()}))}}(jQuery),jQuery.extend({unselectContents:function(){window.getSelection?window.getSelection().removeAllRanges():document.selection&&document.selection.empty()}}),jQuery.fn.extend({selectContents:function(){t(this).each(function(e){var t,n,i,o,a=this;(i=a.ownerDocument)&&(o=i.defaultView)&&"undefined"!=typeof o.getSelection&&"undefined"!=typeof i.createRange&&(t=window.getSelection())&&"undefined"!=typeof t.removeAllRanges?(n=i.createRange(),n.selectNode(a),0==e&&t.removeAllRanges(),t.addRange(n)):document.body&&"undefined"!=typeof document.body.createTextRange&&(n=document.body.createTextRange())&&(n.moveToElementText(a),n.select())})},setCaret:function(){if(t.browser.msie){var e=function(){var e=t(this).get(0);e.caretPos=document.selection.createRange().duplicate()};t(this).click(e).select(e).keyup(e)}},insertAtCaret:function(e){var n=t(this).get(0);if(document.all&&n.createTextRange&&n.caretPos){var i=n.caretPos;i.text=""==i.text.charAt(i.text.length-1)?e+"":e}else if(n.setSelectionRange){var o=n.selectionStart,a=n.selectionEnd,c=n.value.substring(0,o),s=n.value.substring(a);n.value=c+e+s,n.focus();var r=e.length;n.setSelectionRange(o+r,o+r),n.blur()}else n.value+=e}})});