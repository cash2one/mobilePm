Fengs.add("940/video/index",function(i,t){return{init:function(){var i=t(".tab_ul"),e=i.find(".cur");this.listUl=t(".wrap_vlist").find(".v_list_ul");var a=this;i.on("mouseover","li",function(){var i=t(this).index();e.animate({left:t(this).position().left+17},200),t(this).addClass("act").siblings("li").removeClass("act"),a.listUl.eq(i).show().siblings("ul").hide()}),this.getVideo()},getVideo:function(){function i(){if(this.vip&&(null==t.cookie("940_COM_USER")||null==t.cookie("940_COM_PASS")))return void layer.msg("你好，请先登录！",{time:2e3});if(!this.vData)return void layer.msg("无效的视频！",{time:2e3});var i="";i=t(this).siblings("p").length>0?t(this).siblings("p").find("span").text():this.innerHTML,o.html("正在播放："+i),document.title=i;var e=t(this).siblings("span");t.getJSON("/play",{v_id:this.vData},function(){e.text(Number(e.text())+1)}),window.location.href="/video/"+this.vId+".html"}var e=this,a=t(".wrap_video"),n=t(".videoPage"),s=0,l=0,r={videos:function(i,a){t.getJSON("/videoList?type="+a+"&page=1&line=10",function(t){for(var n,s=t.list,l=s.length>10?10:s.length,r="",o=0;l>o;o++)n=3>o?"act":"",r+='<li><i class="fl '+n+'">'+(o+1)+'</i><a class="fl" href="javascript:">'+s[o].title+'</a><span class="fr" title="播放次数">'+s[o].click_num+"</span></li>";e.listUl.eq(i).html(r);for(var d=e.listUl.eq(i).find("li"),o=0;l>o;o++)d.eq(o).find("a")[0].vData=s[o].videoId,d.eq(o).find("a")[0].vId=s[o].id,1==a&&(d.eq(o).find("a")[0].vip=!0)})},vipFreeVideo:function(i,e,n,s){var l=this;t.getJSON("/videoList",{type:e,page:n,line:12},function(n){function r(i,t){var e=new Image;return e.src=i,e.complete?void t.call(e):void(e.onload=function(){t.call(e)})}var o=n.list;t.isArray(o)||(o=[t.parseJSON(o)]),console.log(o);var d="";if(1!=n.status)return void alert("服务器繁忙，请稍后在试！");for(var v=0;v<o.length;v++)d+='<li><a href="javascript:"><img width=175 height=120 data-src="'+o[v].preview+'" width=175 height=120 src="../images/loding.gif"><em class="v_bg"></em><i></i></a><p><em class="'+(1==e?"vip":"")+'">'+(1==e?"VIP":"免费")+"</em><i>|</i><span>"+o[v].title+"</span></p></li>";a.eq(i).html(d),a.eq(i).find("img").each(function(){var i=t(this);r(i.attr("data-src"),function(){i.attr("src",this.src),i.removeAttr("data-src")})});for(var c=a.eq(i).find("li"),v=0;v<o.length;v++)c.eq(v).find("a")[0].vData=o[v].videoId,c.eq(v).find("a")[0].vId=o[v].id,1==e&&(c.eq(v).find("a")[0].vip=!0);s&&l.page(n.count,i,e)})},page:function(i,t,e){for(var a=Math.ceil(i/12),s="",l=0;a>l;l++)s+="<em "+(0==l?'class="act"':"")+">"+(l+1)+"</em>";n.eq(t).html(s),n.eq(t).attr("type",e)}};r.videos(0,3),r.videos(1,4),r.videos(2,1),r.vipFreeVideo(0,2,1,!0),r.vipFreeVideo(1,1,1,!0);e.listUl.on("click","a",i),a.on("click","a",i);var o=(t("html,body"),t(".wrap_video_ul").find("h3"));n.on("click","em",function(){var i=t(this).index(),e=t(this).parent().attr("type");if(1==e){if(s==i)return;s=i}else{if(l==i)return;l=i}t(this).addClass("act").siblings("em").removeClass("act");var a=i+1;r.vipFreeVideo(1==e?1:0,e,a,!1)})}}},["jquery/cookie"]);